<h1>Confirm check-in</h1>

<div>
    Checking in
    <div style="margin-left: 2em;">
    <span shortnodetext uri="{{checkinUri}}"></span>
    from
    <span ng-if="checkinTreeJson">
        <strong ng-switch="checkinTreeJson.arrangementType.name">
            <span ng-switch-when="P">Classification </span>
            <span ng-switch-when="U">Workspace </span>
            <span ng-switch-default>Unrecognised tree type {{checkinTreeJson.arrangementType.name}}</span>
        </strong>
        <u>
        {{checkinTreeJson.label}}
        {{checkinTreeJson.title}}
            </u>
                <a target="viewnode" href="{{checkinUri}}"><i class="fa fabutton fa-link"></i></a>

        <div ng-bind-html="checkinTreeJson.decriptionHtml"/>
    </span>
    </div>
    to replace
    <div style="margin-left: 2em;">
    <span shortnodetext uri="{{targetUri}}"></span>
    in
    <span ng-if="targetTreeJson">
        <strong ng-switch="targetTreeJson.arrangementType.name">
            <span ng-switch-when="P">Classification </span>
            <span ng-switch-when="U">Workspace </span>
            <span ng-switch-default>Unrecognised tree type {{checkinTreeJson.arrangementType.name}}</span>
        </strong>
        <u>
        {{targetTreeJson.label}}
        {{targetTreeJson.title}}
        </u>
        <a target="viewnode" href="{{targetUri}}"><i class="fa fabutton fa-link"></i></a>
        <div ng-bind-html="targetTreeJson.decriptionHtml"/>
    </span>
    </div>
</div>

<div ng-if="verifying">
    Validating <i class="fa fa-spinner fa-spin"></i>
</div>

<div ng-if="!verifying && !checkingIn && verificationResults">
    <hr/>
    <div ng-if="(!verificationResults.problems || verificationResults.problems.length == 0)
                && (!verificationResults.warnings || verificationResults.warnings.length == 0)">
        No problems found with this proposed check-in. Click 'Perform Check-in' to proceed.
    </div>
    <div ng-if="verificationResults.problems && verificationResults.problems.length != 0">
        <h3>This check-in cannot be performed due to the following problems</h3>
        <div ng-repeat="p in verificationResults.problems" nested-message usemessage="p"></div>
    </div>
    <div ng-if="verificationResults.warnings && verificationResults.warnings.length != 0">
        <h3>This check-in will result in the following issues</h3>
        <div ng-repeat="p in verificationResults.warnings" nested-message usemessage="p"></div>
    </div>
</div>

<div ng-if="checkingIn">
    Performing check-in <i class="fa fa-spinner fa-spin"></i>
</div>

<div ng-if="!verifying && !checkingIn && checkinResults">
    <hr/>
    Check-in Results: {{checkinResults}}
</div>

<div ng-if="!checkinResults">
    <hr/>
    <button ng-disabled="verifying || checkingIn" class="btn btn-large btn-info" ng-click="performVerification()">
        Revalidate Check-in
    </button>
    <button ng-disabled="verifying || checkingIn || !verificationResults.goodToGo" class="btn btn-large btn-warning"
            ng-click="performCheckin()">Perform Check-in</button>
</div>
